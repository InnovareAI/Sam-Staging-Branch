"use strict";(()=>{var a={};a.id=6792,a.ids=[6792],a.modules={261:a=>{a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:a=>{a.exports=require("punycode")},19121:a=>{a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},24800:(a,b,c)=>{c.r(b),c.d(b,{handler:()=>M,patchFetch:()=>L,routeModule:()=>H,serverHooks:()=>K,workAsyncStorage:()=>I,workUnitAsyncStorage:()=>J});var d={};c.r(d),c.d(d,{GET:()=>G,POST:()=>F});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(10641),v=c(95009);class w{async qualifyProspect(a,b){let c=[];c.push({step:1,thought:"Analyzing prospect fit against ideal customer profile",reasoning:`Looking at company size (${a.company?.size||"unknown"}), industry (${a.company?.industry||"unknown"}), and role (${a.title||"unknown"}). Need to determine if this matches our successful customer patterns.`,confidence:.8,dependencies:["ICP scoring","historical customer data"],next_steps:["Calculate ICP score","Compare to successful deals"]}),c.push({step:2,thought:"Evaluating buying signals and intent",reasoning:"Examining prospect behavior: website visits, content engagement, response patterns. Strong buying signals include: active research, stakeholder involvement, timeline discussions.",confidence:.75,dependencies:["behavioral data","engagement metrics"],next_steps:["Score buying intent","Identify decision-making unit"]}),c.push({step:3,thought:"Applying MEDDIC qualification framework",reasoning:"Metrics: Can we quantify business impact? Economic Buyer: Is this person or can they access decision maker? Decision Criteria: Do we understand evaluation process? Decision Process: Timeline and stakeholders clear? Identify Pain: Problem urgency validated? Champion: Do we have internal advocate?",confidence:.7,dependencies:["conversation history","stakeholder mapping"],next_steps:["Complete MEDDIC scorecard","Identify gaps"]}),c.push({step:4,thought:"Identifying risks and red flags",reasoning:"Potential risks: budget uncertainty, long decision cycles, multiple stakeholders, competitive pressure, unclear ROI, regulatory concerns. Each risk needs mitigation strategy.",confidence:.85,dependencies:["risk matrix","competitive analysis"],next_steps:["Prioritize risks","Develop mitigation plans"]}),c.push({step:5,thought:"Synthesizing all factors for qualification decision",reasoning:"Weighing ICP fit, buying signals, MEDDIC score, and risk factors. Need to balance opportunity size against probability of success and resource investment required.",confidence:.9,dependencies:["all previous steps"],next_steps:["Make go/no-go decision","Define engagement strategy"]});let d=c.reduce((a,b)=>a+b.confidence,0)/c.length,e=this.calculateICPScore(a),f=this.assessBuyingSignals(a),g=e>.7&&f>.6?"QUALIFIED":"NOT_QUALIFIED",h={final_recommendation:"QUALIFIED"===g?`QUALIFIED: High-potential prospect with ${Math.round(100*e)}% ICP fit and strong buying signals. Recommend immediate sales engagement with focus on ${this.identifyPrimaryPainPoint(a)}.`:`NOT_QUALIFIED: Prospect does not meet qualification threshold. ICP Score: ${Math.round(100*e)}%, Buying Signals: ${Math.round(100*f)}%. Consider nurturing campaign instead.`,reasoning_chain:c,confidence_score:d,risk_assessment:{high_risk_factors:this.identifyRiskFactors(a,g),mitigation_strategies:this.generateMitigationStrategies(a,g)},implementation_plan:this.generateImplementationPlan(g,a),alternative_approaches:this.suggestAlternativeApproaches(g,a)};return this.thinkingHistory.push(h),h}async developDealStrategy(a,b){a.stakeholders,a.requirements;let c=[];c.push({step:1,thought:"Mapping decision-making unit and stakeholder influence",reasoning:"Identifying all stakeholders, their priorities, influence levels, and decision criteria. Economic buyer vs technical evaluators vs end users have different success metrics.",confidence:.85,dependencies:["stakeholder interviews","org chart analysis"],next_steps:["Create influence map","Identify champions and detractors"]}),c.push({step:2,thought:"Analyzing competitive landscape and differentiation",reasoning:"Understanding competitor strengths/weaknesses, customer perception, and our unique value proposition. Need to position against alternatives, not just competition.",confidence:.8,dependencies:["competitive intelligence","customer feedback"],next_steps:["Develop battle cards","Craft differentiation story"]}),c.push({step:3,thought:"Aligning value proposition with business outcomes",reasoning:"Connecting our solution capabilities to specific business outcomes the customer cares about. ROI, risk reduction, operational efficiency, revenue impact.",confidence:.9,dependencies:["business case development","ROI modeling"],next_steps:["Quantify business impact","Build compelling ROI story"]}),c.push({step:4,thought:"Identifying and mitigating deal risks",reasoning:"Deal risks include: competitive threats, budget changes, stakeholder changes, technical concerns, implementation risks, timeline pressures.",confidence:.75,dependencies:["risk assessment framework","historical deal data"],next_steps:["Prioritize risks","Develop specific mitigation tactics"]}),c.push({step:5,thought:"Developing tactical closing approach",reasoning:"Sequence of events to drive decision: pilot programs, executive alignment, contract negotiations, implementation planning. Timeline and momentum management.",confidence:.8,dependencies:["customer decision process","legal/procurement requirements"],next_steps:["Create closing timeline","Secure executive sponsorship"]});let d=c.reduce((a,b)=>a+b.confidence,0)/c.length,e=this.calculateWinProbability(a,b),f={final_recommendation:`Deal Strategy: ${e>.7?"HIGH CONFIDENCE":"MODERATE RISK"} - Win probability ${Math.round(100*e)}%. Focus on ${this.identifyKeySuccessFactors(a)} while mitigating ${this.identifyTopRisks(a,b)}.`,reasoning_chain:c,confidence_score:d,risk_assessment:{high_risk_factors:this.identifyDealRisks(a,b),mitigation_strategies:this.generateDealMitigations(a,b)},implementation_plan:this.generateDealPlan(a,e),alternative_approaches:this.suggestDealAlternatives(a,e)};return this.thinkingHistory.push(f),f}async handleComplexObjection(a,b){b.history,b.competition;let c=[];c.push({step:1,thought:"Classifying objection type and identifying root cause",reasoning:`Objection "${a}" appears to be ${this.classifyObjection(a)}. Need to understand if this is the real concern or surface-level symptom of deeper issue.`,confidence:.85,dependencies:["objection taxonomy","conversation context"],next_steps:["Probe for underlying concerns","Validate objection authenticity"]}),c.push({step:2,thought:"Analyzing how objection affects different stakeholders",reasoning:"This objection may resonate differently with technical evaluators vs economic buyers vs end users. Need to understand impact on each decision maker.",confidence:.8,dependencies:["stakeholder mapping","decision criteria"],next_steps:["Map objection to stakeholder concerns","Identify allies and detractors"]}),c.push({step:3,thought:"Gathering relevant evidence to address objection",reasoning:"Need specific proof points: case studies, references, data, expert opinions, third-party validation that directly refute the objection with credible evidence.",confidence:.9,dependencies:["proof point library","customer references","competitive analysis"],next_steps:["Select most relevant proof points","Prepare supporting materials"]}),c.push({step:4,thought:"Formulating multi-layered response strategy",reasoning:"Response should: 1) Acknowledge concern validity, 2) Provide counter-evidence, 3) Reframe perspective, 4) Offer concrete next steps. Avoid being defensive.",confidence:.85,dependencies:["objection handling framework","communication best practices"],next_steps:["Craft response message","Plan follow-up actions"]}),c.push({step:5,thought:"Planning to recover and maintain deal momentum",reasoning:"After addressing objection, need to refocus on value proposition and next steps. Cannot let objection handling become the entire conversation focus.",confidence:.8,dependencies:["sales process framework","momentum management tactics"],next_steps:["Define immediate next steps","Set follow-up timeline"]});let d=c.reduce((a,b)=>a+b.confidence,0)/c.length,e=this.classifyObjection(a),f=this.generateResponseStrategy(a,e,b),g={final_recommendation:`Objection Handling Strategy: Address ${e} objection with ${f.approach}. Use ${f.primary_tactic} supported by ${f.proof_points.join(", ")}. Follow up with ${f.next_step}.`,reasoning_chain:c,confidence_score:d,risk_assessment:{high_risk_factors:this.identifyObjectionRisks(a,b),mitigation_strategies:this.generateObjectionMitigations(a,b)},implementation_plan:this.generateObjectionHandlingPlan(a,f),alternative_approaches:this.suggestObjectionAlternatives(a,b)};return this.thinkingHistory.push(g),g}calculateICPScore(a){let b=.5;return a.company?.size==="enterprise"&&(b+=.2),(a.title?.toLowerCase().includes("vp")||a.title?.toLowerCase().includes("director"))&&(b+=.15),(a.company?.industry==="technology"||a.company?.industry==="saas")&&(b+=.15),Math.min(b,1)}assessBuyingSignals(a){let b=.4;return a.engagement?.websiteVisits>5&&(b+=.2),a.engagement?.emailOpens>3&&(b+=.1),a.engagement?.responseTime<24&&(b+=.2),a.conversation?.mentionedBudget&&(b+=.1),Math.min(b,1)}identifyPrimaryPainPoint(a){return"operational efficiency"}identifyRiskFactors(a,b){let c=[];return"NOT_QUALIFIED"===b?c.push("Low ICP fit","Weak buying signals","Resource allocation inefficiency"):c.push("Competitive pressure","Budget approval delays","Stakeholder alignment"),c}generateMitigationStrategies(a,b){let c=[];return"NOT_QUALIFIED"===b?c.push("Move to nurturing campaign","Quarterly check-ins","Value-add content sharing"):c.push("Multi-threading strategy","Executive alignment","Proof of concept proposal"),c}generateImplementationPlan(a,b){return"QUALIFIED"===a?[{phase:"Discovery",actions:["Schedule stakeholder interviews","Technical requirements gathering","Business case development"],timeline:"2 weeks",resources_needed:["Sales Rep","Sales Engineer","Solution Consultant"]},{phase:"Proposal",actions:["ROI analysis","Custom demo","Proposal presentation"],timeline:"1 week",resources_needed:["Sales Rep","Technical Team","Pricing Specialist"]}]:[{phase:"Nurturing",actions:["Add to nurture campaign","Quarterly value-add touchpoints"],timeline:"Ongoing",resources_needed:["Marketing Automation","Content Library"]}]}suggestAlternativeApproaches(a,b){return["Partner channel introduction","Event-based re-engagement","Referral from existing customer","Industry conference meetup"]}calculateWinProbability(a,b){let c=.5;return a.champion&&(c+=.15),a.budget_confirmed&&(c+=.1),a.timeline_defined&&(c+=.1),b.preferred_vendor&&(c+=.2),"strong"===a.technical_fit&&(c+=.15),Math.min(c,.95)}identifyKeySuccessFactors(a){return"executive sponsorship and technical validation"}identifyTopRisks(a,b){return"competitive pressure and budget approval timing"}identifyDealRisks(a,b){return["Competitive displacement risk","Budget approval delays","Stakeholder changes","Technical evaluation concerns","Implementation timeline pressures"]}generateDealMitigations(a,b){return["Multi-threading across organization","Executive alignment sessions","Proof of concept with quick wins","Technical validation checkpoints","Phased implementation approach"]}generateDealPlan(a,b){return[{phase:"Stakeholder Alignment",actions:["Executive briefings","Technical workshops","ROI validation"],timeline:"3 weeks",resources_needed:["Account Executive","Sales Engineer","Customer Success"]},{phase:"Proposal & Negotiation",actions:["Custom proposal","Contract negotiations","Implementation planning"],timeline:"2 weeks",resources_needed:["Sales Team","Legal","Implementation Team"]}]}suggestDealAlternatives(a,b){return b<.6?["Pilot program approach","Phased implementation","Partnership model","Competitive displacement timing"]:["Accelerated timeline incentives","Multi-year contract benefits","Strategic partnership opportunities"]}classifyObjection(a){let b=a.toLowerCase();if(b.includes("price")||b.includes("cost")||b.includes("budget"))return"price";if(b.includes("time")||b.includes("timing")||b.includes("later"))return"timing";if(b.includes("authority")||b.includes("decision")||b.includes("boss"))return"authority";if(b.includes("need")||b.includes("priority")||b.includes("important"))return"need";if(b.includes("trust")||b.includes("proven")||b.includes("reference"))return"trust";else if(b.includes("competitor")||b.includes("alternative")||b.includes("comparing"))return"competition";return"general"}generateResponseStrategy(a,b,c){let d={price:{approach:"value-based reframing",primary_tactic:"ROI demonstration",proof_points:["cost savings analysis","productivity gains","risk reduction value"],next_step:"schedule ROI review session"},timing:{approach:"urgency creation",primary_tactic:"opportunity cost analysis",proof_points:["competitive advantage timing","implementation lead times","quarterly impact"],next_step:"propose pilot program"},authority:{approach:"stakeholder engagement",primary_tactic:"decision maker introduction",proof_points:["executive briefing materials","peer references","industry validation"],next_step:"schedule stakeholder meeting"}};return d[b]||d.price}identifyObjectionRisks(a,b){return["Lost momentum in sales cycle","Competitive opportunity for alternatives","Stakeholder confidence erosion","Deal timeline extension"]}generateObjectionMitigations(a,b){return["Address objection with specific evidence","Involve subject matter experts","Provide customer references","Offer risk mitigation guarantees"]}generateObjectionHandlingPlan(a,b){return[{phase:"Immediate Response",actions:["Acknowledge concern","Provide counter-evidence","Reframe perspective"],timeline:"Same conversation",resources_needed:["Sales Rep","Proof points library"]},{phase:"Follow-up Validation",actions:["Send supporting materials","Arrange customer reference call","Schedule next meeting"],timeline:"24-48 hours",resources_needed:["Marketing materials","Customer references","Calendar coordination"]}]}suggestObjectionAlternatives(a,b){return["Third-party validation approach","Pilot program with limited risk","Phased implementation option","Executive sponsor engagement"]}getThinkingHistory(){return this.thinkingHistory}analyzeThinkingPatterns(){return 0===this.thinkingHistory.length?{average_confidence:0,most_common_risks:[],success_rate_by_confidence:{},improvement_opportunities:["Insufficient thinking history for analysis"]}:{average_confidence:this.thinkingHistory.reduce((a,b)=>a+b.confidence_score,0)/this.thinkingHistory.length,most_common_risks:Object.entries(this.thinkingHistory.flatMap(a=>a.risk_assessment.high_risk_factors).reduce((a,b)=>(a[b]=(a[b]||0)+1,a),{})).sort(([,a],[,b])=>b-a).slice(0,5).map(([a])=>a),success_rate_by_confidence:{"high (>0.8)":this.thinkingHistory.filter(a=>a.confidence_score>.8).length/this.thinkingHistory.length,"medium (0.6-0.8)":this.thinkingHistory.filter(a=>a.confidence_score>=.6&&a.confidence_score<=.8).length/this.thinkingHistory.length,"low (<0.6)":this.thinkingHistory.filter(a=>a.confidence_score<.6).length/this.thinkingHistory.length},improvement_opportunities:["Increase data gathering for higher confidence scores","Develop more specific risk mitigation strategies","Improve stakeholder analysis depth","Enhance competitive intelligence integration"]}}constructor(){this.thinkingHistory=[]}}let x=new w;class y{constructor(){this.quotaManager=new z,this.linkedInScraper=new A,this.websiteAnalyzer=new B,this.serviceFitAnalyzer=new C}async enrichProspectData(a,b,c,d="standard"){try{let e=await this.quotaManager.checkQuota(b,c,d);if(!e.allowed)return{quota_status:e.quota,approval_required:!1,estimated_cost:e.estimated_cost,error:"Monthly scraping quota exceeded"};await this.quotaManager.reserveQuota(b,c,e.estimated_cost);let f={...a,linkedin_profile:{},website_intelligence:{},service_fit_analysis:{},enrichment_status:"in_progress",enrichment_timestamp:new Date().toISOString(),data_sources:[],confidence_score:0,manual_review_required:!1,estimated_scraping_cost:e.estimated_cost};return a.linkedin_url&&(console.log("Enriching LinkedIn profile data..."),f.linkedin_profile=await this.linkedInScraper.scrapeProfile(a.linkedin_url,d),f.data_sources.push("linkedin")),a.website_url&&(console.log("Analyzing website intelligence..."),f.website_intelligence=await this.websiteAnalyzer.analyzeWebsite(a.website_url,d),f.data_sources.push("website_analysis")),console.log("Computing service fit analysis..."),f.service_fit_analysis=await this.serviceFitAnalyzer.analyzeServiceFit(f,d),f.confidence_score=this.calculateOverallConfidence(f),f.manual_review_required=this.requiresManualReview(f),f.enrichment_status=f.manual_review_required?"pending":"completed",await this.quotaManager.confirmQuotaUsage(b,c,e.estimated_cost),{enriched_data:f,quota_status:await this.quotaManager.getQuotaStatus(b,c),approval_required:f.manual_review_required,estimated_cost:e.estimated_cost}}catch(a){return await this.quotaManager.releaseReservedQuota(b,c),{quota_status:await this.quotaManager.getQuotaStatus(b,c),approval_required:!1,estimated_cost:0,error:a instanceof Error?a.message:"Enrichment failed"}}}async enrichProspectBatch(a,b,c,d="standard"){let e=[],f=[];for(let g of a)try{let a=await this.enrichProspectData(g,b,c,d);a.enriched_data?e.push(a.enriched_data):a.error&&f.push({prospect:g,error:a.error}),await new Promise(a=>setTimeout(a,1e3))}catch(a){f.push({prospect:g,error:a instanceof Error?a.message:"Unknown error"})}return{enriched_prospects:e,failed_prospects:f,quota_status:await this.quotaManager.getQuotaStatus(b,c),batch_summary:{total:a.length,successful:e.filter(a=>"completed"===a.enrichment_status).length,failed:f.length,pending_approval:e.filter(a=>a.manual_review_required).length}}}calculateOverallConfidence(a){let b=.5,c=0;return a.linkedin_profile?.about_section&&(b+=.15,c++),a.linkedin_profile?.current_position?.description&&(b+=.1,c++),a.website_intelligence?.products_services?.length>0&&(b+=.15,c++),a.website_intelligence?.recent_blog_posts?.length>0&&(b+=.1,c++),a.service_fit_analysis?.icp_score>.7&&(b+=.2,c++),Math.min(b,1)}requiresManualReview(a){return!!(a.service_fit_analysis?.icp_score>.8||a.confidence_score<.6||a.service_fit_analysis?.competitive_threats?.some(a=>"high"===a.threat_level)||a.service_fit_analysis?.pain_points_identified?.some(a=>"high"===a.urgency))}}class z{async checkQuota(a,b,c){let d=await this.getQuotaStatus(a,b),e=this.calculateEnrichmentCost(c);return{allowed:d.current_usage+e<=d.monthly_limit,quota:d,estimated_cost:e}}async getQuotaStatus(a,b){return{user_id:a,workspace_id:b,monthly_limit:2e3,current_usage:450,reset_date:this.getNextMonthFirstDay(),overage_allowed:!0,overage_cost_per_scrape:.05}}async reserveQuota(a,b,c){console.log(`Reserving ${c} quota units for user ${a}`)}async confirmQuotaUsage(a,b,c){console.log(`Confirming ${c} quota units usage for user ${a}`)}async releaseReservedQuota(a,b){console.log(`Releasing reserved quota for user ${a}`)}calculateEnrichmentCost(a){return({basic:1,standard:3,comprehensive:5})[a]||3}getNextMonthFirstDay(){let a=new Date;return new Date(a.getFullYear(),a.getMonth()+1,1).toISOString()}}class A{async scrapeProfile(a,b){try{let c=await this.checkFirstDegreeConnection(a),d=await v.Q7.callTool({method:"tools/call",params:{name:"research_prospect",arguments:{profileUrls:[a],depth:"comprehensive"===b?"comprehensive":"standard"}},server:"bright-data"});return this.parseLinkedInData(d,c)}catch(a){return console.error("LinkedIn scraping error:",a),this.getEmptyLinkedInProfile()}}async checkFirstDegreeConnection(a){try{let b=await v.Q7.callTool({method:"tools/call",params:{name:"unipile_get_accounts"}}),c=JSON.parse(b.content[0].text||"{}").accounts?.filter(a=>"linkedin"===a.platform)||[];if(c.length>0)return await this.getMutualConnectionData(a,c[0].id);return null}catch(a){return console.error("First-degree connection check error:",a),null}}async getMutualConnectionData(a,b){return{is_first_degree:!1,mutual_connections:[],conversation_history:[],can_message_directly:!1}}parseLinkedInData(a,b){try{let c=JSON.parse(a.content[0]?.text||"{}");return{about_section:c.about||"",current_position:{title:c.current_title||"",company:c.current_company||"",duration:c.current_duration||"",description:c.current_description||""},experience_summary:c.experience||[],education:c.education||[],skills:c.skills||[],connections_count:c.connections_count||0,mutual_connections:b?.mutual_connections||[],activity_insights:{recent_posts:c.recent_posts||[],engagement_topics:c.topics||[],posting_frequency:this.assessPostingFrequency(c.recent_posts||[])}}}catch(a){return this.getEmptyLinkedInProfile()}}assessPostingFrequency(a){return a.length>10?"high":a.length>3?"medium":"low"}getEmptyLinkedInProfile(){return{about_section:"",current_position:{title:"",company:"",duration:"",description:""},experience_summary:[],education:[],skills:[],connections_count:0,mutual_connections:[],activity_insights:{recent_posts:[],engagement_topics:[],posting_frequency:"low"}}}}class B{async analyzeWebsite(a,b){try{let[c,d,e]=await Promise.all([this.getSEOData(a),this.getContentData(a,b),this.getTechnologyStack(a)]);return{seo_data:c,products_services:d.products_services,recent_blog_posts:d.blog_posts,technology_stack:e,company_size_indicators:await this.getCompanySizeIndicators(a),business_intelligence:await this.getBusinessIntelligence(d,c)}}catch(a){return console.error("Website analysis error:",a),this.getEmptyWebsiteIntelligence()}}async getSEOData(a){try{let b=await v.Q7.callTool({method:"tools/call",params:{name:"company_intelligence_search",arguments:{query:`site:${a} SEO analysis`,searchType:"company_intelligence",maxResults:5}},server:"websearch"});return JSON.parse(b.content[0]?.text||"{}"),{title:"Website Title",meta_description:"Website description",keywords:["keyword1","keyword2"],organic_traffic_estimate:1e4,domain_authority:45,backlinks_count:1200}}catch(a){return{title:"",meta_description:"",keywords:[],organic_traffic_estimate:0,domain_authority:0,backlinks_count:0}}}async getContentData(a,b){try{let c=await v.Q7.callTool({method:"tools/call",params:{name:"analyze_company",arguments:{website:a,depth:"comprehensive"===b?"deep":"standard"}},server:"bright-data"}),d=JSON.parse(c.content[0]?.text||"{}");return{products_services:d.products||[],blog_posts:d.blog_posts||[]}}catch(a){return{products_services:[],blog_posts:[]}}}async getTechnologyStack(a){return{cms:"WordPress",analytics:["Google Analytics"],marketing_tools:["HubSpot","Mailchimp"],sales_tools:["Salesforce"],development_frameworks:["React","Node.js"]}}async getCompanySizeIndicators(a){return{team_page_count:25,job_postings_count:5,press_mentions_count:12,estimated_employees:50}}async getBusinessIntelligence(a,b){return{industry_category:"Technology",target_market:["SMB","Enterprise"],value_proposition:"Automate business processes",competitive_positioning:"Premium solution",growth_indicators:[{metric:"Blog posting frequency",trend:"growing",evidence:"Monthly blog posts increasing"}]}}getEmptyWebsiteIntelligence(){return{seo_data:{title:"",meta_description:"",keywords:[],organic_traffic_estimate:0,domain_authority:0,backlinks_count:0},products_services:[],recent_blog_posts:[],technology_stack:{cms:"",analytics:[],marketing_tools:[],sales_tools:[],development_frameworks:[]},company_size_indicators:{team_page_count:0,job_postings_count:0,press_mentions_count:0,estimated_employees:0},business_intelligence:{industry_category:"",target_market:[],value_proposition:"",competitive_positioning:"",growth_indicators:[]}}}}class C{async analyzeServiceFit(a,b){try{let b=await x.qualifyProspect({prospect:a,company:a.website_intelligence,linkedin:a.linkedin_profile},{service_offering:"SAM AI Platform",target_markets:["B2B SaaS","Technology","Professional Services"],ideal_company_size:"10-500 employees"});return{icp_score:this.calculateICPScore(a),fit_reasoning:b.reasoning_chain.map(a=>a.reasoning),pain_points_identified:this.identifyPainPoints(a),buying_signals:this.identifyBuyingSignals(a),recommended_approach:this.generateRecommendedApproach(a),competitive_threats:this.identifyCompetitiveThreats(a)}}catch(a){return console.error("Service fit analysis error:",a),this.getEmptyServiceFitAnalysis()}}calculateICPScore(a){let b=.5,c=a.website_intelligence?.company_size_indicators?.estimated_employees||0;c>=10&&c<=500&&(b+=.2);let d=a.website_intelligence?.business_intelligence?.industry_category?.toLowerCase();(d?.includes("technology")||d?.includes("saas"))&&(b+=.15);let e=a.linkedin_profile?.current_position?.title?.toLowerCase();return(e?.includes("vp")||e?.includes("director")||e?.includes("head"))&&(b+=.15),(a.website_intelligence?.technology_stack?.sales_tools||[]).length>0&&(b+=.1),Math.min(b,1)}identifyPainPoints(a){let b=[];return a.website_intelligence?.technology_stack?.sales_tools?.length===0&&b.push({pain_point:"No sales automation tools detected",evidence:["Missing CRM/sales stack in technology analysis"],confidence:.7,urgency:"medium"}),(a.website_intelligence?.business_intelligence?.growth_indicators||[]).some(a=>"growing"===a.trend)&&b.push({pain_point:"Scaling challenges with growth",evidence:["Website shows growth indicators","May need sales process optimization"],confidence:.6,urgency:"high"}),b}identifyBuyingSignals(a){let b=[];(a.website_intelligence?.company_size_indicators?.job_postings_count||0)>3&&b.push({signal_type:"need",indicator:"Active hiring suggests growth and potential need for sales tools",strength:"medium"});let c=a.linkedin_profile?.current_position?.title?.toLowerCase();return(c?.includes("vp")||c?.includes("director"))&&b.push({signal_type:"authority",indicator:"Senior role indicates decision-making authority",strength:"strong"}),b}generateRecommendedApproach(a){return{messaging_angle:"Sales process optimization for growing companies",key_value_props:["Automate lead qualification and enrichment","Increase sales team productivity","Better prospect intelligence"],conversation_starters:["How is your team currently handling lead qualification?","What challenges are you facing with sales process scalability?"],objection_preemption:["ROI typically seen within 60 days","Easy integration with existing sales stack"]}}identifyCompetitiveThreats(a){let b=[],c=a.website_intelligence?.technology_stack?.sales_tools||[];return c.includes("HubSpot")&&b.push({competitor:"HubSpot",threat_level:"medium",differentiation_strategy:"Focus on AI-powered intelligence vs basic CRM"}),c.includes("Salesforce")&&b.push({competitor:"Salesforce",threat_level:"high",differentiation_strategy:"Emphasize ease of use and quick implementation"}),b}getEmptyServiceFitAnalysis(){return{icp_score:0,fit_reasoning:[],pain_points_identified:[],buying_signals:[],recommended_approach:{messaging_angle:"",key_value_props:[],conversation_starters:[],objection_preemption:[]},competitive_threats:[]}}}let D=new y,E=(0,c(82461).UU)("https://latxadqrvrrrcvkktrog.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function F(a){try{let{prospect_data:b,user_id:c,workspace_id:d,enrichment_depth:e="standard"}=await a.json();if(!b||!c||!d)return u.NextResponse.json({error:"Missing required fields: prospect_data, user_id, workspace_id"},{status:400});let f=await D.enrichProspectData(b,c,d,e);if(f.enriched_data){let{error:a}=await E.from("enriched_prospects").insert({workspace_id:d,user_id:c,prospect_id:`${b.first_name}-${b.last_name}-${b.company_name}`,base_data:b,enriched_data:f.enriched_data,enrichment_status:f.enriched_data.enrichment_status,confidence_score:f.enriched_data.confidence_score,icp_score:f.enriched_data.service_fit_analysis?.icp_score||0,manual_review_required:f.approval_required,estimated_cost:f.estimated_cost,created_at:new Date().toISOString()});a&&console.error("Database storage error:",a)}return u.NextResponse.json({success:!0,enriched_data:f.enriched_data,quota_status:f.quota_status,approval_required:f.approval_required,estimated_cost:f.estimated_cost,error:f.error})}catch(a){return console.error("Enrichment API error:",a),u.NextResponse.json({error:a instanceof Error?a.message:"Enrichment failed"},{status:500})}}async function G(a){try{let{searchParams:b}=new URL(a.url),c=b.get("workspace"),d=b.get("user"),e=b.get("prospect_id");if(!c||!d)return u.NextResponse.json({error:"Missing required parameters: workspace, user"},{status:400});let f=E.from("enriched_prospects").select("*").eq("workspace_id",c);e&&(f=f.eq("prospect_id",e));let{data:g,error:h}=await f.order("created_at",{ascending:!1}).limit(100);if(h)throw Error(h.message);return u.NextResponse.json({success:!0,prospects:g||[]})}catch(a){return console.error("Get prospects API error:",a),u.NextResponse.json({error:a instanceof Error?a.message:"Failed to get prospects"},{status:500})}}let H=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/data-enrichment/enrich/route",pathname:"/api/data-enrichment/enrich",filename:"route",bundlePath:"app/api/data-enrichment/enrich/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/Users/tvonlinz/Dev_Master/InnovareAI/Sam-New-Sep-7/app/api/data-enrichment/enrich/route.ts",nextConfigOutput:"standalone",userland:d}),{workAsyncStorage:I,workUnitAsyncStorage:J,serverHooks:K}=H;function L(){return(0,g.patchFetch)({workAsyncStorage:I,workUnitAsyncStorage:J})}async function M(a,b,c){var d;let e="/api/data-enrichment/enrich/route";"/index"===e&&(e="/");let g=await H.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,resolvedPathname:C}=g,D=(0,j.normalizeAppPath)(e),E=!!(y.dynamicRoutes[D]||y.routes[C]);if(E&&!x){let a=!!y.routes[C],b=y.dynamicRoutes[D];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let F=null;!E||H.isDev||x||(F="/index"===(F=C)?"/":F);let G=!0===H.isDev||!E,I=E&&!G,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:G,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>H.onRequestError(a,b,d,z)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>H.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&A&&B&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!E)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await H.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})},z),b}},l=await H.handleResponse({req:a,nextConfig:w,cacheKey:F,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,responseGenerator:k,waitUntil:c.waitUntil});if(!E)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&E||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(L||b instanceof s.NoFallbackError||await H.onRequestError(a,b,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})}),E)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},27910:a=>{a.exports=require("stream")},29294:a=>{a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:a=>{a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55591:a=>{a.exports=require("https")},63033:a=>{a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:a=>{a.exports=require("zlib")},79551:a=>{a.exports=require("url")},81630:a=>{a.exports=require("http")},86439:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external")}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[4586,1692,4842,5077,5009],()=>b(b.s=24800));module.exports=c})();