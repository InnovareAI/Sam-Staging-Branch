(()=>{var a={};a.id=20,a.ids=[20],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8750:(a,b,c)=>{"use strict";c.d(b,{F:()=>h});var d=c(82461);let e=process.env.SUPABASE_SERVICE_ROLE_KEY,f=(0,d.UU)("https://latxadqrvrrrcvkktrog.supabase.co",e);class g{async getByCategory(a){try{let b=f.from("knowledge_base").select("*").eq("is_active",!0).order("created_at",{ascending:!1});a&&(b=b.eq("category",a));let{data:c,error:d}=await b;if(d)return console.error("Error fetching knowledge base:",d),[];return c||[]}catch(a){return console.error("Knowledge base fetch error:",a),[]}}async search(a,b){try{let{data:c,error:d}=await f.rpc("search_knowledge_base",{search_query:a,category_filter:b||null});if(d)return console.error("Error searching knowledge base:",d),[];return c||[]}catch(a){return console.error("Knowledge base search error:",a),[]}}async getPersonaGuidance(a){await this.search("personas founder sales marketing consultant coach agency recruiting financial legal pharma manufacturing");let b=a.toLowerCase();for(let[a,c]of Object.entries({founder:"Growth, fundraising, efficient GTM",sales:"Pipeline generation, conversion rates",marketing:"Brand consistency, multi-channel campaigns",consultant:"High-value client acquisition",coach:"Personal connection, steady lead flow",agency:"Scalable results for clients",recruiting:"Faster placements, higher-quality pipelines",financial:"Trust, compliance, credibility",legal:"Client origination, credibility",pharma:"HCP engagement, compliant communications",manufacturing:"Supply chain efficiency, market expansion"}))if(b.includes(a))return`Based on your ${a} role, I'll focus on: ${c}`;return""}async getObjectionResponse(a){await this.search("objections apollo sales nav hire sdr ai compliance");let b=a.toLowerCase();for(let[a,c]of Object.entries({apollo:"Great tools for data, but SAM orchestrates 14 agents across enrichment, personalization, outreach, replies, and analytics.","sales nav":"Great tools for data, but SAM orchestrates 14 agents across enrichment, personalization, outreach, replies, and analytics.","hire sdr":"SDRs take 3–6 months to ramp. SAM delivers ROI in weeks at 20% of the cost.",ai:"Every message is personalized with context from LinkedIn, websites, and case studies. Feels researched, not robotic.",compliance:"SAM includes HITL approvals, pre-approved disclaimers, and vertical-specific compliance libraries."}))if(b.includes(a))return c;return""}async getIndustryBurst(a){let b=await this.search(`industry ${a} vertical messaging`,"verticals");return b.length>0?b[0].content:""}async getSystemPrompt(){try{let[a,b,c,d,e,f]=await Promise.all([this.search("identity core capabilities","core"),this.search("personas library","core"),this.search("conversation modes","conversational-design"),this.search("error handling","conversational-design"),this.search("objection handling","strategy"),this.search("industry messaging","verticals")]);return`You are Sam, an AI-powered B2B sales assistant with sophisticated training in automated outreach, lead scoring, and personalized messaging.

## Core Identity:
${a[0]?.content||"SAM AI specialized B2B sales assistant"}

## Conversation Modes:
${c[0]?.content||"Four main modes: Onboarding, Product QA, Campaign Management, Repair"}

## Error Handling:
${d[0]?.content||"Comprehensive error recovery strategies"}

## Objection Handling:
${e[0]?.content||"Proven responses to common objections"}

## Industry Intelligence:
${f[0]?.content||"Industry-specific messaging and pain points"}

## Personas Library:
${b[0]?.content||"User personas for targeting and personalization"}

You are context-aware and adapt your responses based on the user's industry, role, and conversation history. Follow the consultant-style approach with professional warmth. Always be helpful, knowledgeable, and focused on delivering value through sales process optimization.`}catch(a){return console.error("Error building system prompt:",a),"You are Sam, an AI-powered B2B sales assistant focused on helping optimize sales processes."}}async addKnowledgeItem(a){try{let{data:b,error:c}=await f.from("knowledge_base").insert([a]).select().single();if(c)return console.error("Error adding knowledge item:",c),null;return b}catch(a){return console.error("Knowledge base add error:",a),null}}async updateKnowledgeItem(a,b){try{let{data:c,error:d}=await f.from("knowledge_base").update(b).eq("id",a).select().single();if(d)return console.error("Error updating knowledge item:",d),null;return c}catch(a){return console.error("Knowledge base update error:",a),null}}async deleteKnowledgeItem(a){try{let{error:b}=await f.from("knowledge_base").update({is_active:!1}).eq("id",a);if(b)return console.error("Error deleting knowledge item:",b),!1;return!0}catch(a){return console.error("Knowledge base delete error:",a),!1}}}let h=new g},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:a=>{"use strict";a.exports=require("punycode")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:a=>{"use strict";a.exports=require("stream")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55591:a=>{"use strict";a.exports=require("https")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:a=>{"use strict";a.exports=require("zlib")},78335:()=>{},79551:a=>{"use strict";a.exports=require("url")},81630:a=>{"use strict";a.exports=require("http")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},88420:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>C,patchFetch:()=>B,routeModule:()=>x,serverHooks:()=>A,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>z});var d={};c.r(d),c.d(d,{POST:()=>w});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(10641),v=c(8750);async function w(a){try{let{message:b,conversationHistory:c=[]}=await a.json();if(!b)return u.NextResponse.json({error:"Message is required"},{status:400});let d=await v.F.getSystemPrompt(),e=await v.F.getPersonaGuidance(b),f=await v.F.getObjectionResponse(b),g="";if(0===c.length)g="Hey there — how's your day going so far? Calm, or one of those fire-drill mornings?";else{let a=b.toLowerCase();g=a.includes("calm")||a.includes("good")||a.includes("quiet")?"Nice, those are rare. Always good to start a chat without too many fires burning.\n\nI'm SAM — think of me as your GTM consultant in AI form. I work alongside founders, sales, and marketing leads to take the heavy lifting out of prospecting, outreach, and follow-up.\n\nBefore we dive into your business, would it help if I give you a quick overview of how I work and the features I bring to the table? Or would you prefer we go straight into your current GTM challenges?":a.includes("hectic")||a.includes("busy")||a.includes("crazy")||a.includes("fire")?"Makes sense — most GTM leaders I talk with are juggling ten things at once. That's exactly why I keep things simple here.\n\nI'm SAM — think of me as your GTM consultant in AI form. I work alongside founders, sales, and marketing leads to take the heavy lifting out of prospecting, outreach, and follow-up.\n\nBefore we dive into your business, would it help if I give you a quick overview of how I work and the features I bring to the table? Or would you prefer we go straight into your current GTM challenges?":a.includes("explain features")||a.includes("overview")||a.includes("how you work")?"Sure thing. Here's the quick version: I coordinate a team of 14 specialized AI agents. Together, they handle lead discovery, enrichment, personalization, outreach, replies, and analytics. I'll walk you through how each part fits your workflow.\n\nWhich area would you like me to dive deeper into first — lead discovery and enrichment, personalized outreach, or automated follow-ups and analytics?":a.includes("challenges")||a.includes("talk about my")||a.includes("straight into")?"Great — let's make this about you. Tell me, where do you feel the most friction in your GTM motion right now — finding leads, personalizing messaging, or staying consistent with follow-ups?":f||(e?e+"\n\nWhat's the biggest challenge you're facing in your current sales process?":"I'm SAM — your GTM consultant in AI form. I help founders, sales, and marketing teams take the heavy lifting out of prospecting and outreach.\n\nWhat's bringing you here today? Are you looking to scale your lead generation, improve your outreach personalization, or streamline your follow-up process?")}return u.NextResponse.json({response:g,timestamp:new Date().toISOString(),knowledgeUsed:{personaDetected:!!e,objectionHandled:!!f,systemPromptLength:d.length}})}catch(a){return console.error("SAM Chat API error:",a),u.NextResponse.json({error:"Internal server error"},{status:500})}}let x=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/sam/chat/route",pathname:"/api/sam/chat",filename:"route",bundlePath:"app/api/sam/chat/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/Users/tvonlinz/Dev_Master/InnovareAI/Sam-New-Sep-7/app/api/sam/chat/route.ts",nextConfigOutput:"standalone",userland:d}),{workAsyncStorage:y,workUnitAsyncStorage:z,serverHooks:A}=x;function B(){return(0,g.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:z})}async function C(a,b,c){var d;let e="/api/sam/chat/route";"/index"===e&&(e="/");let g=await x.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:y,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(z.dynamicRoutes[E]||z.routes[D]);if(F&&!y){let a=!!z.routes[D],b=z.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||x.isDev||y||(G="/index"===(G=D)?"/":G);let H=!0===x.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:z,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>x.onRequestError(a,b,d,A)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>x.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await x.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await x.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),y&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(L||b instanceof s.NoFallbackError||await x.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},96487:()=>{}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[586,692,461],()=>b(b.s=88420));module.exports=c})();