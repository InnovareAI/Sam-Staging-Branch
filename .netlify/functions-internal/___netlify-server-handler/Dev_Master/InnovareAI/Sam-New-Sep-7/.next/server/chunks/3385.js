"use strict";exports.id=3385,exports.ids=[3385],exports.modules={83385:(a,b,c)=>{c.d(b,{activeCampaignService:()=>e});class d{constructor(){if(this.baseUrl=process.env.ACTIVECAMPAIGN_BASE_URL||"",this.apiKey=process.env.ACTIVECAMPAIGN_API_KEY||"",!this.baseUrl||!this.apiKey)throw Error("ActiveCampaign API credentials not configured")}async request(a,b="GET",c){let d=`${this.baseUrl}/api/3/${a}`,e={method:b,headers:{"Api-Token":this.apiKey,"Content-Type":"application/json"}};c&&("POST"===b||"PUT"===b)&&(e.body=JSON.stringify(c));try{let a=await fetch(d,e);if(!a.ok){let b=await a.text();throw Error(`ActiveCampaign API error (${a.status}): ${b}`)}return await a.json()}catch(a){throw console.error("ActiveCampaign API request failed:",a),a}}async getLists(){return(await this.request("lists")).lists||[]}async findOrCreateContact(a){try{let b=await this.request(`contacts?email=${encodeURIComponent(a.email)}`);if(b.contacts&&b.contacts.length>0)return console.log(`Contact ${a.email} already exists in ActiveCampaign`),b.contacts[0];let c={contact:{email:a.email,firstName:a.firstName||"",lastName:a.lastName||"",phone:a.phone||"",fieldValues:a.fieldValues||[]}},d=await this.request("contacts","POST",c);return console.log(`Created new contact in ActiveCampaign: ${a.email}`),d.contact}catch(b){throw console.error(`Error finding/creating contact ${a.email}:`,b),b}}async addContactToList(a,b){try{let c=await this.request("contactLists","POST",{contactList:{list:b,contact:a,status:1}});return console.log(`Added contact ${a} to list ${b}`),c}catch(c){throw console.error(`Error adding contact ${a} to list ${b}:`,c),c}}async getTags(){try{return(await this.request("tags")).tags||[]}catch(a){throw console.error("Error getting tags:",a),a}}async findOrCreateTag(a){try{let b=await this.request("tags"),c=b.tags?.find(b=>b.tag===a);if(c)return console.log(`Tag "${a}" already exists in ActiveCampaign`),c;let d={tag:{tag:a,tagType:"contact",description:`Company tag for ${a}`}},e=await this.request("tags","POST",d);return console.log(`Created new tag in ActiveCampaign: ${a}`),e.tag}catch(b){throw console.error(`Error finding/creating tag ${a}:`,b),b}}async addTagToContact(a,b){try{let c=await this.request("contactTags","POST",{contactTag:{contact:a,tag:b}});return console.log(`Added tag ${b} to contact ${a}`),c}catch(c){throw console.error(`Error adding tag ${b} to contact ${a}:`,c),c}}async addNewMemberToList(a,b,c,d,e){try{console.log(`Adding ${a} to ActiveCampaign list ${d}...`);let f=await this.findOrCreateContact({email:a,firstName:b,lastName:c,fieldValues:e?.fieldValues||[]});return await this.addContactToList(f.id,d),console.log(`‚úÖ Successfully added ${a} to ActiveCampaign list ${d}`),{success:!0,contactId:f.id}}catch(b){return console.error(`‚ùå Failed to add ${a} to ActiveCampaign list ${d}:`,b),{success:!1,error:b.message}}}async addSamUserToList(a,b,c,d){try{console.log(`üöÄ Adding SAM user ${a} from ${d} to ActiveCampaign...`);let e=await this.findOrCreateContact({email:a,firstName:b,lastName:c,fieldValues:[]}),f=(await this.getLists()).find(a=>"SAM"===a.name);f||(console.log("SAM list not found, creating it..."),f=(await this.request("lists","POST",{list:{name:"SAM",stringid:"sam-users",sender_url:"https://app.meet-sam.com",sender_reminder:"You subscribed to SAM AI Platform updates",send_last_broadcast:0,carboncopy:"",subscription_notify:"",unsubscription_notify:"",to_name:"SAM User",optinoptout:1,sender_name:"InnovareAI"===d?"Sarah Powell - SAM AI":"Sophia Caldwell - SAM AI",sender_addr1:"",sender_addr2:"",sender_city:"",sender_state:"",sender_zip:"",sender_country:"",sender_phone:"",fulladdress:"",codepeek:0,description:"SAM AI Platform users from both InnovareAI and 3CubedAI"}})).list,console.log(`‚úÖ Created SAM list: ${f.id}`)),await this.addContactToList(e.id,f.id);let g=await this.findOrCreateTag(d);return await this.addTagToContact(e.id,g.id),console.log(`‚úÖ Successfully added ${a} to SAM list with ${d} tag`),{success:!0,contactId:e.id,listId:f.id,tagId:g.id,company:d}}catch(b){return console.error(`‚ùå Failed to add SAM user ${a}:`,b),{success:!1,error:b.message}}}async testConnection(){try{let a=await this.request("lists?limit=1");return console.log("‚úÖ ActiveCampaign connection successful"),{success:!0,data:a}}catch(a){return console.error("‚ùå ActiveCampaign connection failed:",a),{success:!1,error:a.message}}}}let e=new d}};