(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[956],{63:(e,t,s)=>{"use strict";var a=s(7260);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},2181:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(5105).A)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},2987:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(5155),i=s(2115),n=s(63),r=s(6117),l=s(6983);let c=(0,s(5105).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var o=s(9408),d=s(2181);function m(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),[s,m]=(0,i.useState)(null),[h,x]=(0,i.useState)(!0),[u,p]=(0,i.useState)(null),[y,v]=(0,i.useState)(!1);(0,i.useEffect)(()=>{e.token&&f(e.token)},[e.token]);let f=async e=>{try{let{data:t,error:s}=await r.N.from("workspace_invites").select("\n          *,\n          workspaces!workspace_invites_workspace_id_fkey (name),\n          users!workspace_invites_invited_by_fkey (first_name, last_name, email)\n        ").eq("token",e).single();if(s||!t)return void p("Invalid or expired invitation");if(new Date(t.expires_at)<new Date)return void p("This invitation has expired");if(t.accepted_at)return void p("This invitation has already been accepted");m({...t,workspace:t.workspaces,invited_by:t.users})}catch(e){console.error("Failed to load invite:",e),p("Failed to load invitation")}finally{x(!1)}},j=async()=>{if(s){v(!0);try{let{data:{user:a}}=await r.N.auth.getUser();if(!a){let t=new URL("/api/auth/signup",window.location.origin);t.searchParams.set("invite_token",e.token),t.searchParams.set("email",s.email),window.location.href=t.toString();return}let i=await fetch("/api/invites/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e.token})});if(i.ok)t.push("/settings?tab=workspaces&accepted=true");else{let e=await i.json();p(e.error||"Failed to accept invitation")}}catch(e){console.error("Failed to accept invite:",e),p("Failed to accept invitation")}finally{v(!1)}}};if(h)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(l.A,{className:"animate-spin mx-auto mb-4",size:48}),(0,a.jsx)("p",{children:"Loading invitation..."})]})});if(u)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,a.jsx)(c,{className:"mx-auto mb-4 text-red-500",size:64}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Invalid Invitation"}),(0,a.jsx)("p",{className:"text-gray-400 mb-6",children:u}),(0,a.jsx)("a",{href:"/api/auth/signin",className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg inline-block transition-colors",children:"Sign In to SAM AI"})]})});if(!s)return null;let k="".concat(s.invited_by.first_name||""," ").concat(s.invited_by.last_name||"").trim()||s.invited_by.email,g=new Date(s.expires_at),w=Math.ceil((g.getTime()-Date.now())/864e5);return(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,a.jsx)("div",{className:"max-w-lg mx-auto px-6",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-8 shadow-xl",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"bg-purple-600 rounded-full p-4 w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:(0,a.jsx)(o.A,{size:32})}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"You're Invited!"}),(0,a.jsxs)("p",{className:"text-gray-400",children:["Join ",(0,a.jsx)("strong",{children:s.workspace.name})," on SAM AI"]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Invitation Details"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Workspace:"}),(0,a.jsx)("span",{children:s.workspace.name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Role:"}),(0,a.jsx)("span",{className:"capitalize",children:s.role})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Invited by:"}),(0,a.jsx)("span",{children:k})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Your email:"}),(0,a.jsx)("span",{children:s.email})]})]})]}),(0,a.jsx)("div",{className:"bg-yellow-900/20 border border-yellow-600 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(l.A,{className:"mr-2 text-yellow-500",size:16}),(0,a.jsxs)("span",{className:"text-yellow-200 text-sm",children:["Expires in ",w," day",1!==w?"s":"","(",g.toLocaleDateString(),")"]})]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("button",{onClick:j,disabled:y,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-green-700 disabled:opacity-50 text-white py-3 px-6 rounded-lg font-semibold transition-colors flex items-center justify-center",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{className:"animate-spin mr-2",size:16}),"Accepting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"mr-2",size:16}),"Accept Invitation"]})}),(0,a.jsx)("p",{className:"text-center text-sm text-gray-400",children:"By accepting, you'll create an account or join the workspace if you're already signed in."})]})]})]})})})}},5105:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(2115),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(e,t)=>{let s=(0,a.forwardRef)((s,n)=>{let{color:r="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:o,className:d="",children:m,...h}=s;return(0,a.createElement)("svg",{ref:n,...i,width:l,height:l,stroke:r,strokeWidth:o?24*Number(c)/Number(l):c,className:["lucide","lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()),d].join(" "),...h},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])});return s.displayName="".concat(e),s}},5187:(e,t,s)=>{Promise.resolve().then(s.bind(s,2987))},6117:(e,t,s)=>{"use strict";s.d(t,{N:()=>i});var a=s(5040);s(5704).env.SUPABASE_SERVICE_ROLE_KEY;let i=(0,a.UU)("https://latxadqrvrrrcvkktrog.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxhdHhhZHFydnJycmN2a2t0cm9nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2OTk5ODYsImV4cCI6MjA2ODI3NTk4Nn0.3WkAgXpk_MyQioVf_SED9O_ArjcT9nH0uy9we2okftE")},6983:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(5105).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},9408:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(5105).A)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])}},e=>{e.O(0,[40,441,255,358],()=>e(e.s=5187)),_N_E=e.O()}]);